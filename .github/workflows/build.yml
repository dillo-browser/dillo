name: CI

on: [push]

jobs:
  ubuntu-latest-no-tls:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
      with:
        fetch-depth: 1
    - name: Install dependencies
      run: sudo apt install -y libfltk1.3-dev
    - name: autogen
      run: ./autogen.sh
    - name: configure
      run: ./configure --disable-tls
    - name: make
      run: make
    - name: make check
      run: make check
    - name: make distcheck
      run: make distcheck
  ubuntu-latest-mbedtls2:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
      with:
        fetch-depth: 1
    - name: Install dependencies
      run: sudo apt install -y libfltk1.3-dev libmbedtls-dev
    - name: autogen
      run: ./autogen.sh
    - name: configure
      run: ./configure --disable-openssl
    - name: make
      run: make
    - name: make check
      run: make check
    - name: make distcheck
      run: make distcheck
  ubuntu-latest-openssl-3:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
      with:
        fetch-depth: 1
    - name: Install dependencies
      run: sudo apt install -y libfltk1.3-dev libssl-dev
    - name: autogen
      run: ./autogen.sh
    - name: configure
      run: ./configure --disable-mbedtls
    - name: make
      run: make
    - name: make check
      run: make check
    - name: make distcheck
      run: make distcheck
  ubuntu-20-04-openssl-1-1:
    runs-on: ubuntu-20.04
    steps:
    - uses: actions/checkout@v1
      with:
        fetch-depth: 1
    - name: Install dependencies
      run: sudo apt install -y libfltk1.3-dev libssl-dev
    - name: autogen
      run: ./autogen.sh
    - name: configure
      run: ./configure --disable-mbedtls
    - name: make
      run: make
    - name: make check
      run: make check
    - name: make distcheck
      run: make distcheck
  macOS-13-openssl-1-1:
    runs-on: macos-13
    steps:
    - uses: actions/checkout@v1
      with:
        fetch-depth: 1
    - name: Install dependencies
      run: brew install autoconf automake fltk
    - name: autogen
      run: ./autogen.sh
    - name: configure
      run: ./configure --disable-mbedtls
    - name: make
      run: make
    - name: make check
      run: make check
    - name: make distcheck
      run: make distcheck
